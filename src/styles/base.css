/* ===== DESIGN SYSTEM BASE ===== */

/* @layer base - Tokens, resets, and foundational styles */
@layer base {
  :root {
    /* Colors */
    --bg: #F7F8FA;
    --card: #FFFFFF;
    --surface-2: #F1F5F9;
    --border: #E6E8EB;
    --text: #0B1220;
    --text-muted: #475569;
    --text-soft: #64748B;
    --brand: #0B1220;
    --brand-weak: #0B1220E6;
    --success: #16A34A;
    --success-strong: #15803D;
    --focus: #0EA5E9;
    --shadow-color: rgba(9, 17, 33, 0.12);

    /* Radius */
    --radius-all: 16px;
    --radius-pill: 999px;

    /* Spacing scale */
    --space-1: 4px;
    --space-2: 8px;
    --space-3: 12px;
    --space-4: 16px;
    --space-5: 20px;
    --space-6: 24px;
    --space-8: 32px;

    /* Shadow */
    --shadow-card: 0 6px 16px rgba(9,17,33,0.08);
    --shadow-elevated: 0 10px 24px rgba(9,17,33,0.10);
    --shadow-focus-ring: 0 0 0 3px rgba(14,165,233,0.25);

    /* Typography */
    --font-family-sans: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;

    --h1-size: 22px;
    --h1-weight: 600;
    --h1-line: 28px;
    --h1-tracking: -0.2px;

    --h2-size: 18px;
    --h2-weight: 700;
    --h2-line: 24px;

    --label-size: 16px;
    --label-weight: 600;
    --label-line: 20px;

    --body-size: 15px;
    --body-weight: 500;
    --body-line: 22px;

    --fine-size: 13px;
    --fine-weight: 500;
    --fine-line: 18px;

    /* Motion */
    --motion-fast: 120ms;
    --motion-base: 180ms;
    --motion-slow: 240ms;
    --ease-in: cubic-bezier(0.4,0,1,1);
    --ease-out: cubic-bezier(0,0,0.2,1);
    --ease-inout: cubic-bezier(0.2,0,0,1);

    /* Layout sizing */
    --header-h: 56px;
    --product-header-h: 0px;
    --stepper-h: 0px;
    --actions-h: 72px;
    --safari-ui-h: 60px;
  }

  html, body { 
    height: 100%; 
  }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: var(--font-family-sans);
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Remove spinners for number inputs */
  input[type="number"]::-webkit-outer-spin-button,
  input[type="number"]::-webkit-inner-spin-button { 
    -webkit-appearance: none; 
    margin: 0; 
  }
  input[type="number"] { 
    -moz-appearance: textfield; 
  }

  /* Mobile no-scroll helpers */
  .pt-safe { 
    padding-top: max(0px, env(safe-area-inset-top)); 
  }
  .pb-safe { 
    padding-bottom: max(0px, env(safe-area-inset-bottom)); 
  }
  .NoScrollPage { 
    min-height: 100dvh; 
    display: flex; 
    flex-direction: column; 
  }
  .HeroFill { 
    min-height: calc(100dvh - var(--header-h) - env(safe-area-inset-top) - env(safe-area-inset-bottom)); 
    overflow: hidden; 
  }

  /* Focus management */
  .focus-visible:focus-visible {
    outline: 2px solid var(--focus);
    outline-offset: 2px;
  }
}

/* @layer components - Layout and UI components */
@layer components {
  /* Headers */
  .app-header { 
    position: sticky; 
    top: 0; 
    left: 0; 
    right: 0; 
    z-index: 50; 
    background: rgba(255, 255, 255, 0.92); 
    backdrop-filter: blur(20px) saturate(180%); 
    -webkit-backdrop-filter: blur(20px) saturate(180%); 
    border-bottom: 0.5px solid rgba(0, 0, 0, 0.08); 
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.04), 0 4px 12px rgba(0, 0, 0, 0.02); 
    width: 100%; 
    margin: 0; 
    padding: 0; 
    transition: all var(--motion-base) var(--ease-inout); 
  }
  .app-header .header-content { 
    height: var(--header-h); 
    display: flex; 
    align-items: center; 
    justify-content: space-between; 
    padding-left: max(12px, env(safe-area-inset-left)); 
    padding-right: max(12px, env(safe-area-inset-right)); 
    width: 100%; 
  }
  @media (min-width: 768px) { 
    .app-header .header-content { 
      padding-left: max(24px, env(safe-area-inset-left)); 
      padding-right: max(24px, env(safe-area-inset-right)); 
    } 
  }

  /* Stepper */
  .stepper-item { 
    display: flex; 
    align-items: center; 
    justify-content: center;
    position: relative; 
  }
  .stepper-dot { 
    width: 6px; 
    height: 6px; 
    border-radius: 50%; 
    background: var(--surface-2); 
    border: 1px solid var(--border); 
    transition: all var(--motion-base) var(--ease-inout); 
  }
  .stepper-dot.active { 
    background: var(--brand); 
    border-color: var(--brand); 
    transform: scale(1.3); 
  }
  .stepper-dot.completed { 
    background: var(--brand); 
    border-color: var(--brand); 
    opacity: 0.6; 
  }

  /* Layout containers */
  .app-container { 
    width: 100%; 
    max-width: 680px; 
    margin: 0 auto; 
    padding-left: max(20px, env(safe-area-inset-left)); 
    padding-right: max(20px, env(safe-area-inset-right)); 
    padding-top: 4px; 
    padding-bottom: 8px; 
    min-height: calc(100dvh - var(--header-h) - var(--product-header-h) - var(--stepper-h) - var(--actions-h) - var(--safari-ui-h)); 
  }
  @media (min-height: 700px) { 
    .app-container { 
      display: grid; 
      align-content: center; 
      row-gap: 12px; 
    } 
  }
  @media (min-width: 768px) { 
    .app-container { 
      max-width: 700px; 
      padding-left: max(24px, env(safe-area-inset-left)); 
      padding-right: max(24px, env(safe-area-inset-right)); 
    } 
  }

  /* Cards */
  .app-card { 
    background: var(--card); 
    border-radius: var(--radius-all); 
    box-shadow: var(--shadow-card); 
    padding: 20px; 
    min-height: 0; 
    transition: all var(--motion-base) var(--ease-inout); 
  }
  .app-container .app-card:first-child { 
    margin-top: 2px; 
    padding-top: 16px; 
  }
  .app-card:hover { 
    transform: translateY(-2px); 
    box-shadow: var(--shadow-elevated); 
  }
  @media (min-width: 768px) { 
    .app-card { 
      padding: 24px; 
      min-height: 0; 
    } 
  }

  /* Docked actions */
  .safari-spacer { 
    height: calc(var(--safari-ui-h) + env(safe-area-inset-bottom)); 
    min-height: calc(var(--safari-ui-h) + env(safe-area-inset-bottom)); 
    flex-shrink: 0; 
  }
  .docked-actions { 
    position: sticky; 
    bottom: calc(var(--safari-ui-h) + env(safe-area-inset-bottom)); 
    z-index: 60; 
    border-top: 1px solid var(--border); 
    background: rgba(255, 255, 255, 0.9); 
    backdrop-filter: blur(20px); 
    -webkit-backdrop-filter: blur(20px); 
    margin-bottom: calc(-1 * (var(--safari-ui-h) + env(safe-area-inset-bottom))); 
  }
  @supports (backdrop-filter: blur(20px)) { 
    .docked-actions { 
      background: rgba(255, 255, 255, 0.6); 
    } 
  }
  .docked-actions .container { 
    margin: 0 auto; 
    max-width: 680px; 
    padding-left: max(20px, env(safe-area-inset-left)); 
    padding-right: max(20px, env(safe-area-inset-right)); 
    padding-top: 12px; 
    padding-bottom: 12px; 
  }
  .docked-actions .grid { 
    grid-template-columns: 44% 54%; 
    gap: 16px; 
  }
  .docked-actions button { 
    height: 52px; 
    font-size: 17px; 
    font-weight: 700; 
  }

  /* Form controls */
  .app-input { 
    height: 44px; 
    border-radius: var(--radius-all); 
    border: 1px solid var(--border); 
    padding: 0 12px; 
    background: #fff; 
    color: var(--text); 
    transition: all var(--motion-base) var(--ease-inout); 
  }
  .app-input::placeholder { 
    color: var(--text-soft); 
  }
  .app-input:focus { 
    outline: none; 
    border-color: #A5D8F3; 
    box-shadow: var(--shadow-focus-ring); 
    transform: translateY(-1px); 
  }

  .app-checkbox { 
    width: 22px; 
    height: 22px; 
    border-radius: var(--radius-all); 
    border: 1px solid var(--border); 
    transition: all var(--motion-base) var(--ease-inout); 
  }
  .app-checkbox:checked { 
    background: var(--success); 
    transform: scale(1.1); 
  }
  .checkbox-touch { 
    padding: 12px; 
    margin: -12px; 
    border-radius: var(--radius-all); 
    transition: background-color var(--motion-base) var(--ease-inout); 
  }
  .checkbox-touch:hover { 
    background-color: rgba(0,0,0,0.05); 
  }

  /* Buttons */
  .btn-primary { 
    min-height: 48px; 
    border-radius: var(--radius-pill); 
    background: var(--brand); 
    color: #fff; 
    padding-left: 16px; 
    padding-right: 16px; 
    transition: all var(--motion-base) var(--ease-inout); 
  }
  .btn-primary[data-variant="success"] { 
    background: var(--success); 
  }
  .btn-primary:hover { 
    transform: translateY(-2px); 
    box-shadow: 0 8px 25px rgba(0,0,0,0.15); 
  }
  .btn-primary:active { 
    transform: translateY(0); 
  }
  .btn-secondary { 
    min-height: 48px; 
    border-radius: var(--radius-pill); 
    background: white; 
    color: var(--brand); 
    border: 1px solid var(--border); 
    padding-left: 16px; 
    padding-right: 16px; 
    transition: all var(--motion-base) var(--ease-inout); 
  }
  .btn-secondary:hover { 
    transform: translateY(-2px); 
    box-shadow: 0 8px 25px rgba(0,0,0,0.1); 
  }
  .btn-secondary:active { 
    transform: translateY(0); 
  }

  /* Segmented control */
  .segmented-track { 
    height: 44px; 
    background: rgba(120, 120, 128, 0.12); 
    border-radius: 16px; 
    padding: 4px; 
    position: relative; 
    display: flex; 
    align-items: center; 
    gap: 2px; 
    backdrop-filter: blur(10px); 
    -webkit-backdrop-filter: blur(10px); 
  }
  .segmented-thumb { 
    background: rgba(255, 255, 255, 0.92); 
    box-shadow: 0 0.5px 3px rgba(0, 0, 0, 0.12), 0 4px 16px rgba(0, 0, 0, 0.08); 
    border-radius: 12px; 
    height: 36px; 
    transition: all 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94); 
    position: absolute; 
    top: 4px; 
    backdrop-filter: blur(20px); 
    -webkit-backdrop-filter: blur(20px); 
    border: 0.5px solid rgba(255, 255, 255, 0.8); 
  }
  .segmented-option { 
    flex: 1; 
    height: 36px; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    font-size: 14px; 
    font-weight: 600; 
    color: rgba(60, 60, 67, 0.7); 
    transition: all 0.25s cubic-bezier(0.25, 0.46, 0.45, 0.94); 
    position: relative; 
    z-index: 2; 
    cursor: pointer; 
    border-radius: 12px; 
    letter-spacing: -0.2px; 
  }
  .segmented-option:hover { 
    color: rgba(60, 60, 67, 0.8); 
  }
  .segmented-option.active { 
    color: rgba(60, 60, 67, 1); 
    font-weight: 600; 
  }

  /* Slider */
  .slider-track { 
    height: 8px; 
    background: #E5E7EB; 
    border-radius: var(--radius-pill); 
  }
  .slider-active { 
    background: var(--brand); 
    height: 100%; 
    transition: width var(--motion-base) var(--ease-inout); 
  }
  .slider-thumb { 
    width: 24px; 
    height: 24px; 
    background: #fff; 
    border-radius: var(--radius-pill); 
    border: 1px solid var(--border); 
    box-shadow: 0 6px 16px rgba(0,0,0,.16); 
    transition: all var(--motion-base) var(--ease-inout); 
  }
  .slider-thumb:hover { 
    transform: scale(1.1); 
  }

  /* Summary rows */
  .summary-row { 
    min-height: 50px; 
    border: 1px solid var(--border); 
    border-radius: var(--radius-all); 
    padding-left: 12px; 
    padding-right: 12px; 
    display: flex; 
    align-items: center; 
    justify-content: space-between; 
    background: #fff; 
    transition: all var(--motion-base) var(--ease-inout); 
  }
  .summary-row:hover { 
    transform: translateY(-1px); 
    box-shadow: 0 4px 12px rgba(0,0,0,0.08); 
  }

  .compact-summary-row { 
    min-height: 44px; 
    border: 1px solid var(--border); 
    border-radius: var(--radius-all); 
    padding-left: 12px; 
    padding-right: 12px; 
    display: flex; 
    align-items: center; 
    justify-content: space-between; 
    background: rgba(248, 249, 250, 0.8); 
    transition: all var(--motion-base) var(--ease-inout); 
    cursor: pointer; 
  }
  .compact-summary-row:hover { 
    background: rgba(248, 249, 250, 1); 
    transform: translateY(-1px); 
    box-shadow: 0 2px 8px rgba(0,0,0,0.04); 
  }

  /* Special buttons */
  .paypal-btn { 
    min-height: 56px; 
    border-radius: var(--radius-all); 
    background: #F7F9FC; 
    border: 1px solid var(--border); 
    display: inline-flex; 
    align-items: center; 
    justify-content: center; 
    gap: 8px; 
    padding: 0 16px; 
    transition: all var(--motion-base) var(--ease-inout); 
  }
  .paypal-btn:hover { 
    transform: translateY(-1px); 
    box-shadow: 0 4px 12px rgba(0,0,0,0.08); 
  }

  /* Notes */
  .inline-note { 
    background: #FFFFFF; 
    border: 1px solid var(--border); 
    border-radius: var(--radius-all); 
    padding: 12px; 
    display: flex; 
    align-items: flex-start; 
    gap: 8px; 
    transition: all var(--motion-base) var(--ease-inout); 
  }
  .inline-note:hover { 
    transform: translateY(-1px); 
    box-shadow: 0 4px 12px rgba(0,0,0,0.08); 
  }

  /* Typography */
  .app-title { 
    font-size: 22px; 
    line-height: 28px; 
    font-weight: 600; 
    letter-spacing: -0.2px; 
    color: var(--text); 
  }
  .card-title { 
    font-size: 16px; 
    line-height: 22px; 
    font-weight: 700; 
    color: var(--text); 
  }
  .chip { 
    min-height: 40px; 
    border-radius: 999px; 
    border: 1px solid var(--border); 
    background: #fff; 
    padding: 0 12px; 
    font-size: 14px; 
    font-weight: 600; 
  }
  .app-subtitle { 
    font-size: var(--h2-size); 
    line-height: var(--h2-line); 
    font-weight: var(--h2-weight); 
    color: var(--text); 
  }
  .text-fine { 
    font-size: var(--fine-size); 
    line-height: var(--fine-line); 
    font-weight: var(--fine-weight); 
    color: var(--text-soft); 
  }
}

/* @layer utilities - Helper classes */
@layer utilities {
  .line-clamp-2 { 
    display: -webkit-box; 
    -webkit-line-clamp: 2; 
    -webkit-box-orient: vertical; 
    overflow: hidden; 
  }
  .pressable { 
    transition: transform var(--motion-base) var(--ease-inout), opacity var(--motion-base) var(--ease-inout); 
  }
  .pressable:active { 
    transform: translateY(.5px) scale(.996); 
  }
}

/* @layer animations - Keyframes and animations */
@layer animations {
  /* Stepper pulse */
  @keyframes step-pulse {
    0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(14,165,233,0.0); }
    70% { transform: scale(1.12); box-shadow: 0 0 0 6px rgba(14,165,233,0.10); }
    100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(14,165,233,0); }
  }
  .stepper-dot.active { 
    animation: step-pulse 1.8s var(--ease-inout) infinite; 
  }

  /* Page transitions */
  .page-transition { 
    transition: all var(--motion-slow) var(--ease-inout); 
  }
  .page-transition.slide-out { 
    animation: slide-out var(--motion-slow) var(--ease-in) forwards; 
  }
  .page-transition.slide-in { 
    animation: slide-in var(--motion-slow) var(--ease-out) forwards; 
  }
  @keyframes slide-out { 
    from { opacity: 1; transform: translateX(0); } 
    to { opacity: 0; transform: translateX(-20px); } 
  }
  @keyframes slide-in { 
    from { opacity: 0; transform: translateX(20px); } 
    to { opacity: 1; transform: translateX(0); } 
  }

  /* Donate overlay */
  .donate-overlay { 
    position: fixed; 
    inset: 0; 
    pointer-events: none; 
    z-index: 1000; 
    clip-path: circle(0px at var(--cx, 50%) var(--cy, 100%)); 
    background: linear-gradient(180deg, rgba(11,18,32,0.96) 0%, rgba(11,18,32,0.92) 100%); 
    transition: clip-path var(--motion-slow) var(--ease-inout), opacity var(--motion-slow) var(--ease-inout); 
    opacity: 0; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
  }
  .donate-overlay.open { 
    pointer-events: auto; 
    clip-path: circle(150% at var(--cx, 50%) var(--cy, 100%)); 
    opacity: 1; 
  }
  .donate-overlay-content { 
    color: #fff; 
    text-align: center; 
    display: flex; 
    flex-direction: column; 
    gap: 12px; 
    padding: 24px; 
  }
  .donate-overlay { 
    color: #fff; 
    background: var(--brand); 
  }
  .donate-overlay-content .btn-secondary { 
    background: rgba(255,255,255,0.08); 
    color: #fff; 
    border-color: rgba(255,255,255,0.25); 
  }
  .donate-overlay-content .btn-secondary:hover { 
    background: rgba(255,255,255,0.14); 
  }
  .donate-overlay-content .btn-primary { 
    background: #fff; 
    color: var(--brand); 
  }

  /* Dock enter animation */
  @keyframes dock-enter { 
    from { transform: translateY(8px); opacity: 0; } 
    to { transform: translateY(0); opacity: 1; } 
  }
} 